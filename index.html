<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Essential Financial Calculators</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #f7f7f9;
      color: #222;
      margin: 0;
      padding: 0 0 40px 0;
    }
    h1 {
      text-align: center;
      margin-top: 32px;
      margin-bottom: 8px;
      font-size: 2.2em;
      color: #2d3a4b;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 24px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 16px rgba(0,0,0,0.09);
    }
    h2 {
      border-left: 4px solid #4e8cff;
      padding-left: 12px;
      margin-top: 32px;
      margin-bottom: 12px;
      color: #2d3a4b;
      font-size: 1.3em;
    }
    form {
      display: flex;
      flex-wrap: wrap;
      gap: 12px 24px;
      align-items: center;
      background: #f2f6fc;
      border-radius: 6px;
      padding: 16px 12px 8px 12px;
      margin-bottom: 16px;
      box-shadow: 0 1px 4px rgba(78,140,255,0.04);
    }
    label {
      flex: 1 1 180px;
      margin-bottom: 4px;
      font-size: 0.98em;
    }
    input[type="number"], input[type="text"] {
      width: 120px;
      padding: 4px 7px;
      border-radius: 4px;
      border: 1px solid #b1c9e8;
      font-size: 1em;
      margin-bottom: 8px;
      box-sizing: border-box;
    }
    button {
      background: #4e8cff;
      color: #fff;
      border: none;
      border-radius: 4px;
      padding: 7px 18px;
      font-size: 1em;
      cursor: pointer;
      margin-bottom: 8px;
      transition: background 0.15s;
    }
    button:hover {
      background: #2563d6;
    }
    .result {
      flex: 1 1 100%;
      font-weight: 600;
      color: #1a3c6d;
      margin-top: 4px;
      margin-bottom: 2px;
      font-size: 1.06em;
    }
    @media (max-width: 700px) {
      .container { padding: 8px; }
      form { flex-direction: column; gap: 8px; }
      label, .result { width: 100%; }
    }
</style>
</head>
<body>
  <h1>Essential Financial Calculators</h1>
  <div class="container">

    <!-- 1. Total Manufacturing Cost -->
    <h2>Total Manufacturing Cost</h2>
    <form onsubmit="event.preventDefault(); calcTotalManufacturingCost(this);">
      <label>Direct Materials: <input type="number" step="any" name="materials" required></label>
      <label>Direct Labor: <input type="number" step="any" name="labor" required></label>
      <label>Manufacturing Overhead: <input type="number" step="any" name="overhead" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="tmc_result"></div>
    </form>

    <!-- 2. Direct Materials Cost -->
    <h2>Direct Materials Cost</h2>
    <form onsubmit="event.preventDefault(); calcDirectMaterialsCost(this);">
      <label>Beginning Inventory: <input type="number" step="any" name="begin" required></label>
      <label>Purchases: <input type="number" step="any" name="purchases" required></label>
      <label>Ending Inventory: <input type="number" step="any" name="end" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="dmc_result"></div>
    </form>

    <!-- 3. Direct Labor Cost -->
    <h2>Direct Labor Cost</h2>
    <form onsubmit="event.preventDefault(); calcDirectLaborCost(this);">
      <label>Hourly Wage: <input type="number" step="any" name="wage" required></label>
      <label>Hours Worked: <input type="number" step="any" name="hours" required></label>
      <label>Payroll Taxes: <input type="number" step="any" name="taxes" required></label>
      <label>Employee Benefits: <input type="number" step="any" name="benefits" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="dlc_result"></div>
    </form>

    <!-- 4. Overhead Allocation Rate -->
    <h2>Overhead Allocation Rate</h2>
    <form onsubmit="event.preventDefault(); calcOverheadAllocation(this);">
      <label>Estimated Total Overhead: <input type="number" step="any" name="overhead" required></label>
      <label>Estimated Activity Base: <input type="number" step="any" name="activity" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="oar_result"></div>
    </form>

    <!-- 5. Gross Profit & Margin -->
    <h2>Gross Profit &amp; Margin</h2>
    <form onsubmit="event.preventDefault(); calcGrossProfit(this);">
      <label>Revenue: <input type="number" step="any" name="revenue" required></label>
      <label>Cost of Goods Sold: <input type="number" step="any" name="cogs" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="gp_result"></div>
    </form>

    <!-- 6. Contribution Margin -->
    <h2>Contribution Margin</h2>
    <form onsubmit="event.preventDefault(); calcContributionMargin(this);">
      <label>Sales Price per Unit: <input type="number" step="any" name="price" required></label>
      <label>Variable Cost per Unit: <input type="number" step="any" name="vcost" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="cm_result"></div>
    </form>

    <!-- 7. Break-Even Point -->
    <h2>Break-Even Point</h2>
    <form onsubmit="event.preventDefault(); calcBreakEven(this);">
      <label>Fixed Costs: <input type="number" step="any" name="fixed" required></label>
      <label>Sales Price per Unit: <input type="number" step="any" name="price" required></label>
      <label>Variable Cost per Unit: <input type="number" step="any" name="vcost" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="be_result"></div>
    </form>

    <!-- 8. Return on Investment (ROI) -->
    <h2>Return on Investment (ROI)</h2>
    <form onsubmit="event.preventDefault(); calcROI(this);">
      <label>Net Profit: <input type="number" step="any" name="profit" required></label>
      <label>Cost of Investment: <input type="number" step="any" name="cost" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="roi_result"></div>
    </form>

    <!-- 9. Payback Period -->
    <h2>Payback Period</h2>
    <form onsubmit="event.preventDefault(); calcPayback(this);">
      <label>Investment Cost: <input type="number" step="any" name="cost" required></label>
      <label>Annual Net Cash Inflow: <input type="number" step="any" name="inflow" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="payback_result"></div>
    </form>

    <!-- 10. Net Present Value (NPV) -->
    <h2>Net Present Value (NPV)</h2>
    <form onsubmit="event.preventDefault(); calcNPV(this);">
      <label>Initial Investment: <input type="number" step="any" name="initial" required></label>
      <label>Discount Rate (%): <input type="number" step="any" name="rate" required></label>
      <label>Cash Flows (comma separated): <input type="text" name="flows" required placeholder="e.g. 1000,1200,1300"></label>
      <button type="submit">Calculate</button>
      <div class="result" id="npv_result"></div>
    </form>

    <!-- 11. Internal Rate of Return (IRR) -->
    <h2>Internal Rate of Return (IRR)</h2>
    <form onsubmit="event.preventDefault(); calcIRR(this);">
      <label>Initial Investment: <input type="number" step="any" name="initial" required></label>
      <label>Cash Flows (comma separated): <input type="text" name="flows" required placeholder="e.g. 1000,1200,1300"></label>
      <button type="submit">Calculate</button>
      <div class="result" id="irr_result"></div>
    </form>

    <!-- 12. Accounting Equation -->
    <h2>Accounting Equation</h2>
    <form onsubmit="event.preventDefault(); calcAccountingEq(this);">
      <label>Liabilities: <input type="number" step="any" name="liabilities" required></label>
      <label>Owner's Equity: <input type="number" step="any" name="equity" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="aeq_result"></div>
    </form>

    <!-- 13. Current Ratio -->
    <h2>Current Ratio</h2>
    <form onsubmit="event.preventDefault(); calcCurrentRatio(this);">
      <label>Current Assets: <input type="number" step="any" name="assets" required></label>
      <label>Current Liabilities: <input type="number" step="any" name="liabilities" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="cratio_result"></div>
    </form>

    <!-- 14. Quick Ratio -->
    <h2>Quick Ratio</h2>
    <form onsubmit="event.preventDefault(); calcQuickRatio(this);">
      <label>Current Assets: <input type="number" step="any" name="assets" required></label>
      <label>Inventory: <input type="number" step="any" name="inventory" required></label>
      <label>Current Liabilities: <input type="number" step="any" name="liabilities" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="qratio_result"></div>
    </form>

    <!-- 15. Debt-to-Equity Ratio -->
    <h2>Debt-to-Equity Ratio</h2>
    <form onsubmit="event.preventDefault(); calcDebtEquity(this);">
      <label>Total Liabilities: <input type="number" step="any" name="liabilities" required></label>
      <label>Owner's Equity: <input type="number" step="any" name="equity" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="debt_result"></div>
    </form>

    <!-- 16. Average Freight Cost per Unit -->
    <h2>Average Freight Cost per Unit</h2>
    <form onsubmit="event.preventDefault(); calcFreight(this);">
      <label>Total Freight Costs: <input type="number" step="any" name="total" required></label>
      <label>Number of Units Shipped: <input type="number" step="any" name="units" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="freight_result"></div>
    </form>

    <!-- 17. Total Cost Including Tax -->
    <h2>Total Cost Including Tax</h2>
    <form onsubmit="event.preventDefault(); calcTotalTax(this);">
      <label>Purchase Price: <input type="number" step="any" name="price" required></label>
      <label>Combined Sales Tax Rate (%): <input type="number" step="any" name="tax" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="tax_result"></div>
    </form>

    <!-- 18. Net Income -->
    <h2>Net Income</h2>
    <form onsubmit="event.preventDefault(); calcNetIncome(this);">
      <label>Income From Operations: <input type="number" step="any" name="ops" required></label>
      <label>Interest Income: <input type="number" step="any" name="interest" required></label>
      <label>Income Taxes: <input type="number" step="any" name="tax" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="ni_result"></div>
    </form>

    <!-- 19. Operating Expenses -->
    <h2>Operating Expenses</h2>
    <form onsubmit="event.preventDefault(); calcOperatingExpenses(this);">
      <label>Sales & Marketing: <input type="number" step="any" name="sales" required></label>
      <label>Research & Development: <input type="number" step="any" name="rd" required></label>
      <label>General & Administrative: <input type="number" step="any" name="ga" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="opx_result"></div>
    </form>

    <!-- 20. Cost of Goods Sold (COGS) -->
    <h2>Cost of Goods Sold (COGS)</h2>
    <form onsubmit="event.preventDefault(); calcCOGS(this);">
      <label>Beginning Finished Goods Inventory: <input type="number" step="any" name="begin" required></label>
      <label>Total Manufacturing Cost: <input type="number" step="any" name="tmc" required></label>
      <label>Ending Finished Goods Inventory: <input type="number" step="any" name="end" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="cogs_result"></div>
    </form>

    <!-- 21. Activity-Based Costing -->
    <h2>Activity-Based Costing</h2>
    <form onsubmit="event.preventDefault(); calcActivityBased(this);">
      <label>Total Cost of Activity: <input type="number" step="any" name="total" required></label>
      <label>Number of Cost Driver Units: <input type="number" step="any" name="drivers" required></label>
      <label>Number of Activities Used: <input type="number" step="any" name="used" required></label>
      <button type="submit">Calculate</button>
      <div class="result" id="abc_result"></div>
    </form>

  </div>
  <script>
// Initialize console logging
console.log('DOM fully loaded and parsed');

// 1. Total Manufacturing Cost
function calcTotalManufacturingCost(form) {
  try {
    const m = parseFloat(form.materials.value) || 0;
    const l = parseFloat(form.labor.value) || 0;
    const o = parseFloat(form.overhead.value) || 0;

    if([m, l, o].some(isNaN)) throw new Error('Invalid numeric input');

    document.getElementById('tmc_result').textContent = 
      `Total Manufacturing Cost: $${(m + l + o).toFixed(2)}`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('tmc_result').textContent = 
      'Error: Check input values';
  }
}

// 2. Direct Materials Cost
function calcDirectMaterialsCost(form) {
  try {
    const b = parseFloat(form.begin.value) || 0;
    const p = parseFloat(form.purchases.value) || 0;
    const e = parseFloat(form.end.value) || 0;

    if([b, p, e].some(isNaN)) throw new Error('Invalid numeric input');

    document.getElementById('dmc_result').textContent = 
      `Direct Materials Cost: $${(b + p - e).toFixed(2)}`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('dmc_result').textContent = 
      'Error: Check input values';
  }
}

// 3. Direct Labor Cost
function calcDirectLaborCost(form) {
  try {
    const w = parseFloat(form.wage.value) || 0;
    const h = parseFloat(form.hours.value) || 0;
    const t = parseFloat(form.taxes.value) || 0;
    const b = parseFloat(form.benefits.value) || 0;

    if([w, h, t, b].some(isNaN)) throw new Error('Invalid numeric input');

    document.getElementById('dlc_result').textContent = 
      `Direct Labor Cost: $${(w * h + t + b).toFixed(2)}`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('dlc_result').textContent = 
      'Error: Check input values';
  }
}

// 4. Overhead Allocation Rate
function calcOverheadAllocation(form) {
  try {
    const o = parseFloat(form.overhead.value) || 0;
    const a = parseFloat(form.activity.value) || 0;

    if([o, a].some(isNaN)) throw new Error('Invalid numeric input');

    if (a === 0) {
      throw new Error('Activity base cannot be zero');
    }

    document.getElementById('oar_result').textContent = 
      `Overhead Allocation Rate: $${(o / a).toFixed(2)}`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('oar_result').textContent = 
      `Error: ${error.message || 'Check input values'}`;
  }
}

// 5. Gross Profit & Margin
function calcGrossProfit(form) {
  try {
    const rev = parseFloat(form.revenue.value) || 0;
    const cogs = parseFloat(form.cogs.value) || 0;

    if([rev, cogs].some(isNaN)) throw new Error('Invalid numeric input');

    const gp = rev - cogs;
    const margin = rev !== 0 ? (gp / rev * 100) : 0;

    document.getElementById('gp_result').textContent = 
      `Gross Profit: $${gp.toFixed(2)} | Gross Margin: ${margin.toFixed(2)}%`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('gp_result').textContent = 
      'Error: Check input values';
  }
}

// 6. Contribution Margin
function calcContributionMargin(form) {
  try {
    const price = parseFloat(form.price.value) || 0;
    const vcost = parseFloat(form.vcost.value) || 0;

    if([price, vcost].some(isNaN)) throw new Error('Invalid numeric input');

    const cm = price - vcost;
    const ratio = price !== 0 ? (cm / price) : 0;

    document.getElementById('cm_result').textContent = 
      `Contribution Margin: $${cm.toFixed(2)} | Ratio: ${(ratio * 100).toFixed(2)}%`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('cm_result').textContent = 
      'Error: Check input values';
  }
}

// 7. Break-Even Point
function calcBreakEven(form) {
  try {
    const fixed = parseFloat(form.fixed.value) || 0;
    const price = parseFloat(form.price.value) || 0;
    const vcost = parseFloat(form.vcost.value) || 0;

    if([fixed, price, vcost].some(isNaN)) throw new Error('Invalid numeric input');

    const cm = price - vcost;
    if (cm === 0) {
      throw new Error('Sales price per unit must be greater than variable cost per unit');
    }

    const units = fixed / cm;
    const ratio = price !== 0 ? (cm / price) : 0;
    const sales = ratio !== 0 ? (fixed / ratio) : 0;

    document.getElementById('be_result').textContent = 
      `Break-Even (Units): ${units.toFixed(2)} | Break-Even (Sales $): $${sales.toFixed(2)}`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('be_result').textContent = 
      `Error: ${error.message || 'Check input values'}`;
  }
}

// 8. ROI
function calcROI(form) {
  try {
    const profit = parseFloat(form.profit.value) || 0;
    const cost = parseFloat(form.cost.value) || 0;

    if([profit, cost].some(isNaN)) throw new Error('Invalid numeric input');

    if (cost === 0) {
      throw new Error('Cost of investment cannot be zero');
    }

    const roi = (profit / cost) * 100;

    document.getElementById('roi_result').textContent = 
      `ROI: ${roi.toFixed(2)}%`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('roi_result').textContent = 
      `Error: ${error.message || 'Check input values'}`;
  }
}

// 9. Payback Period
function calcPayback(form) {
  try {
    const cost = parseFloat(form.cost.value) || 0;
    const inflow = parseFloat(form.inflow.value) || 0;

    if([cost, inflow].some(isNaN)) throw new Error('Invalid numeric input');

    if (inflow === 0) {
      throw new Error('Annual net cash inflow cannot be zero');
    }

    const period = cost / inflow;

    document.getElementById('payback_result').textContent = 
      `Payback Period: ${period.toFixed(2)} years`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('payback_result').textContent = 
      `Error: ${error.message || 'Check input values'}`;
  }
}

// 10. NPV
function calcNPV(form) {
  try {
    const initial = parseFloat(form.initial.value) || 0;
    const rate = parseFloat(form.rate.value) / 100 || 0;

    if([initial, rate].some(isNaN)) throw new Error('Invalid numeric input');

    const flows = form.flows.value.split(',').map(x => {
      const val = parseFloat(x.trim());
      if (isNaN(val)) throw new Error('Invalid cash flow values');
      return val;
    });

    let npv = -initial;
    for (let t = 0; t < flows.length; t++) {
      npv += flows[t] / Math.pow(1 + rate, t + 1);
    }

    document.getElementById('npv_result').textContent = 
      `NPV: $${npv.toFixed(2)}`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('npv_result').textContent = 
      `Error: ${error.message || 'Check input values'}`;
  }
}

// 11. IRR (simple iterative approach)
function calcIRR(form) {
  try {
    const initial = -Math.abs(parseFloat(form.initial.value)) || 0;

    if(isNaN(initial)) throw new Error('Invalid initial investment');

    const flows = form.flows.value.split(',').map(x => {
      const val = parseFloat(x.trim());
      if (isNaN(val)) throw new Error('Invalid cash flow values');
      return val;
    });

    // Check if valid cash flow pattern for IRR calculation
    if (!flows.some(val => val > 0) || !flows.some(val => val < 0)) {
      throw new Error('Need both positive and negative cash flows for IRR');
    }

    let guess = 0.1, step = 0.0001, maxIter = 10000, tol = 1e-5, irr = guess;

    for (let i = 0; i < maxIter; i++) {
      let npv = initial;
      for (let t = 0; t < flows.length; t++) {
        npv += flows[t] / Math.pow(1 + irr, t + 1);
      }
      if (Math.abs(npv) < tol) break;
      irr += (npv > 0 ? step : -step);

      // Break if irr goes extreme
      if (irr > 1 || irr < -0.9) {
        throw new Error('Cannot converge to valid IRR');
      }
    }

    document.getElementById('irr_result').textContent = 
      `IRR: ${(irr * 100).toFixed(2)}%`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('irr_result').textContent = 
      `Error: ${error.message || 'Check input values'}`;
  }
}

// 12. Accounting Equation
function calcAccountingEq(form) {
  try {
    const l = parseFloat(form.liabilities.value) || 0;
    const e = parseFloat(form.equity.value) || 0;

    if([l, e].some(isNaN)) throw new Error('Invalid numeric input');

    document.getElementById('aeq_result').textContent = 
      `Assets: $${(l + e).toFixed(2)}`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('aeq_result').textContent = 
      'Error: Check input values';
  }
}

// 13. Current Ratio
function calcCurrentRatio(form) {
  try {
    const a = parseFloat(form.assets.value) || 0;
    const l = parseFloat(form.liabilities.value) || 0;

    if([a, l].some(isNaN)) throw new Error('Invalid numeric input');

    if (l === 0) {
      throw new Error('Current liabilities cannot be zero');
    }

    document.getElementById('cratio_result').textContent = 
      `Current Ratio: ${(a / l).toFixed(2)}`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('cratio_result').textContent = 
      `Error: ${error.message || 'Check input values'}`;
  }
}

// 14. Quick Ratio
function calcQuickRatio(form) {
  try {
    const a = parseFloat(form.assets.value) || 0;
    const i = parseFloat(form.inventory.value) || 0;
    const l = parseFloat(form.liabilities.value) || 0;

    if([a, i, l].some(isNaN)) throw new Error('Invalid numeric input');

    if (l === 0) {
      throw new Error('Current liabilities cannot be zero');
    }

    document.getElementById('qratio_result').textContent = 
      `Quick Ratio: ${((a - i) / l).toFixed(2)}`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('qratio_result').textContent = 
      `Error: ${error.message || 'Check input values'}`;
  }
}

// 15. Debt-to-Equity Ratio
function calcDebtEquity(form) {
  try {
    const l = parseFloat(form.liabilities.value) || 0;
    const e = parseFloat(form.equity.value) || 0;

    if([l, e].some(isNaN)) throw new Error('Invalid numeric input');

    if (e === 0) {
      throw new Error('Owner\'s equity cannot be zero');
    }

    document.getElementById('debt_result').textContent = 
      `Debt-to-Equity Ratio: ${(l / e).toFixed(2)}`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('debt_result').textContent = 
      `Error: ${error.message || 'Check input values'}`;
  }
}

// 16. Average Freight Cost per Unit
function calcFreight(form) {
  try {
    const t = parseFloat(form.total.value) || 0;
    const u = parseFloat(form.units.value) || 0;

    if([t, u].some(isNaN)) throw new Error('Invalid numeric input');

    if (u === 0) {
      throw new Error('Number of units cannot be zero');
    }

    document.getElementById('freight_result').textContent = 
      `Average Freight Cost per Unit: $${(t / u).toFixed(2)}`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('freight_result').textContent = 
      `Error: ${error.message || 'Check input values'}`;
  }
}

// 17. Total Cost Including Tax
function calcTotalTax(form) {
  try {
    const p = parseFloat(form.price.value) || 0;
    const t = parseFloat(form.tax.value) / 100 || 0;

    if([p, t].some(isNaN)) throw new Error('Invalid numeric input');

    document.getElementById('tax_result').textContent = 
      `Total Cost with Tax: $${(p * (1 + t)).toFixed(2)}`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('tax_result').textContent = 
      'Error: Check input values';
  }
}

// 18. Net Income
function calcNetIncome(form) {
  try {
    const ops = parseFloat(form.ops.value) || 0;
    const interest = parseFloat(form.interest.value) || 0;
    const tax = parseFloat(form.tax.value) || 0;

    if([ops, interest, tax].some(isNaN)) throw new Error('Invalid numeric input');

    document.getElementById('ni_result').textContent = 
      `Net Income: $${(ops + interest - tax).toFixed(2)}`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('ni_result').textContent = 
      'Error: Check input values';
  }
}

// 19. Operating Expenses
function calcOperatingExpenses(form) {
  try {
    const s = parseFloat(form.sales.value) || 0;
    const r = parseFloat(form.rd.value) || 0;
    const g = parseFloat(form.ga.value) || 0;

    if([s, r, g].some(isNaN)) throw new Error('Invalid numeric input');

    document.getElementById('opx_result').textContent = 
      `Operating Expenses: $${(s + r + g).toFixed(2)}`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('opx_result').textContent = 
      'Error: Check input values';
  }
}

// 20. COGS
function calcCOGS(form) {
  try {
    const b = parseFloat(form.begin.value) || 0;
    const tmc = parseFloat(form.tmc.value) || 0;
    const e = parseFloat(form.end.value) || 0;

    if([b, tmc, e].some(isNaN)) throw new Error('Invalid numeric input');

    document.getElementById('cogs_result').textContent = 
      `COGS: $${(b + tmc - e).toFixed(2)}`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('cogs_result').textContent = 
      'Error: Check input values';
  }
}

// 21. Activity-Based Costing
function calcActivityBased(form) {
  try {
    const t = parseFloat(form.total.value) || 0;
    const d = parseFloat(form.drivers.value) || 0;
    const u = parseFloat(form.used.value) || 0;

    if([t, d, u].some(isNaN)) throw new Error('Invalid numeric input');

    if (d === 0) {
      throw new Error('Number of cost driver units cannot be zero');
    }

    const costPer = t / d;
    const prodCost = costPer * u;

    document.getElementById('abc_result').textContent = 
      `Cost per Activity: $${costPer.toFixed(2)} | Product Cost: $${prodCost.toFixed(2)}`;
  } catch (error) {
    console.error('Calculation error:', error);
    document.getElementById('abc_result').textContent = 
      `Error: ${error.message || 'Check input values'}`;
  }
}

// Add DOM ready event listener
document.addEventListener('DOMContentLoaded', () => {
  console.log('Calculators initialized and ready');
});
</script></body>
</html>
